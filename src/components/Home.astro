---
import NowPlayingCard from "../components/NowPlayingCard.astro";
import BlogCard from "../components/BlogCard.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("blog")).sort(
  (a: { data: { date: { getTime: () => number; }; }; }, b: { data: { date: { getTime: () => number; }; }; }) => b.data.date.getTime() - a.data.date.getTime()
);

const pinned = posts.filter((p: { data: { pinned: any; }; }) => p.data.pinned);
const featured = pinned[0] ?? posts[0];
const more = posts.filter((p: { slug: any; }) => p.slug !== featured?.slug).slice(0, 2);
---

<main class="min-h-screen bg-gradient-to-b from-teal-50 via-white to-stone-200">
  <section class="w-full min-h-[60vh] flex flex-col justify-center items-center px-6 text-center">
    <h1 class="text-4xl sm:text-5xl font-bold text-zinc-900 mb-4">
      Welcome to my Personal Website
    </h1>

    <p class="text-lg text-zinc-600 max-w-2xl mx-auto mb-8">
      Work in progress — the blog & about page are live. More coming soon :)
    </p>

    <NowPlayingCard class="mt-10" />
  </section>

  {featured && (
    <section class="mx-auto max-w-6xl px-6 py-14">
      <div class="mb-6 flex items-end justify-between gap-4">
        <h2 class="text-2xl sm:text-3xl font-semibold text-zinc-900">From the Blog</h2>
        <a href="/blog" class="text-teal-700 font-medium hover:underline">View all →</a>
      </div>

      <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
        <BlogCard post={featured} />
        {more.map((p: unknown) => <BlogCard post={p} />)}
      </div>
    </section>
  )}
</main>
